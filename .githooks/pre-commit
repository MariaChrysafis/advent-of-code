#!/bin/sh

ROOT=$(git rev-parse --show-toplevel)

for year in 2023 2025; do
    echo "=== Checking $year ==="
    cd "$ROOT/$year"

    echo "Running cargo fmt --check..."
    cargo fmt --check
    if [ $? -ne 0 ]; then
        echo "Formatting check failed in $year. Run 'cargo fmt' to fix."
        exit 1
    fi

    echo "Running cargo clippy..."
    cargo clippy -- -D warnings
    if [ $? -ne 0 ]; then
        echo "Clippy check failed in $year. Fix the warnings above."
        exit 1
    fi
done

echo "All checks passed!"
exit 0
